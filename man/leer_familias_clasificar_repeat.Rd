% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/codificacion.R
\name{leer_familias_clasificar_repeat}
\alias{leer_familias_clasificar_repeat}
\title{Leer y clasificar Excel de familias (repeat-aware, 1 hoja "familias")}
\usage{
leer_familias_clasificar_repeat(
  path,
  inst,
  tabs,
  sheet = "familias",
  verbose = TRUE
)
}
\arguments{
\item{path}{Ruta del Excel de familias (una hoja "familias").}

\item{inst}{Instrumento leído (debe contener \code{survey} y \code{choices}, ideal \code{survey_raw}/\code{choices_raw}).}

\item{tabs}{Lista de datos por hoja: salida de \code{lector_codif_repeat()} (p.ej. \code{main}, \code{s1}, \code{childedupe}, etc.).}

\item{sheet}{Nombre de la hoja (default "familias").}

\item{verbose}{Imprimir mini-resumen (default TRUE).}
}
\value{
lista con \code{familias_filtradas}, \code{select_multiple}, \code{select_one}, \code{text},
\code{familias_enriquecidas}, \code{choices_usadas}, \code{adopciones}, \code{textos_huerfanos}, \code{resumen}.
}
\description{
\itemize{
\item Lee una sola hoja "familias" con columnas estándar + nuevas: \code{section} y/o \code{hoja_datos}.
\item Verifica existencia de columnas en la hoja de datos correcta (según \code{hoja_datos}/\code{section}) dentro de \code{tabs}.
\item Ignora cualquier QOrder del Excel y recalcula \code{q_order} con el orden del survey de \code{inst}.
\item Mantiene la lógica de adopciones: SO/SM adoptan \code{text_col}; los TEXT finales son huérfanos no adoptados.
}
}
