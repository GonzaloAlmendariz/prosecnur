% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lector_limpieza.R
\name{lector_limpieza}
\alias{lector_limpieza}
\title{Lector robusto de Excel RMS/ODK con hojas repetidas}
\usage{
lector_limpieza(archivo, hoja_principal = NULL, grupos_repetidos = NULL)
}
\arguments{
\item{archivo}{Ruta al .xlsx}

\item{hoja_principal}{Nombre de la hoja principal (tolerante a acentos/espacios).
Si no se proporciona, se infiere.}

\item{grupos_repetidos}{Vector opcional con nombres de hojas repetidas (tolerante).
Si no se proporciona, se detectan por columnas típicas (\verb{_parent_index}, etc.).}
}
\value{
Una lista con:
\itemize{
\item \code{data}: lista de data.frames por hoja (normalizados)
\item \code{meta$keys}: tibble con claves por hoja (key y parent_key)
\item \code{meta$parent_map}: tibble con relaciones hijo→padre
\item \code{counts}: tibble con conteos por padre para cada repeat
}
}
\description{
Lee un archivo Excel exportado de KoBo/ODK (o similar), normaliza nombres
de columnas y detecta relaciones padre–hijo entre hoja principal y grupos
repetidos. Agrega conteos \verb{n_<repeat>} a la hoja principal cuando existe
el vínculo, y devuelve metadatos útiles para validación.
}
