% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lector_limpieza.R
\name{lector_limpieza}
\alias{lector_limpieza}
\title{Lector de datos ODK/XLSForm con repeats (limpieza y metadatos)}
\usage{
lector_limpieza(path, hoja_principal = NULL, grupos_repetidos = NULL)
}
\arguments{
\item{path}{Ruta al archivo Excel.}

\item{hoja_principal}{(opcional) Nombre de la hoja principal tal como aparece en Excel
(no sensible a mayúsculas, espacios o tildes).}

\item{grupos_repetidos}{(opcional) Vector con nombres de hojas repeat.
Si no se provee, se detectan automáticamente por presencia de \verb{_parent_index}
o \verb{_submission__id} en sus columnas.}
}
\value{
Una lista con:
\itemize{
\item \code{data$main}: dataframe principal con columnas \verb{n_<repeat>}.
\item \code{data$repeats}: lista de dataframes por repeat.
\item \code{meta$keys}: tibble con columnas \code{table}, \code{key}, \code{parent_key}.
\item \code{meta$parent_map}: vector con orden de tablas: principal + repeats.
\item \code{meta$counts}: tibble largo con \code{parent_key}, \code{n}, \code{repeat_name}, \code{parent_table}.
}
}
\description{
Lee un archivo Excel exportado desde ODK/Enketo/Kobo, detecta la hoja principal
y las hojas de secciones repetidas (repeats), enlaza padre-hijo usando
\verb{_submission__id} ↔ \verb{_id} (si existe) o \verb{_parent_index} ↔ \verb{_index} (fallback),
construye conteos \verb{n_<repeat>} y devuelve un objeto con datos y metadatos.
}
\examples{
\dontrun{
datos <- lector_limpieza("datos_RMS.xlsx",
                         hoja_principal   = "RMS 2025 Perú - Q4",
                         grupos_repetidos = c("rpt_hhmnames","childedupe","s1"))
datos$meta$keys
names(datos$data$main) |> grep("^n_", ., value = TRUE)
}
}
