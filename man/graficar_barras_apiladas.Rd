% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/graficador_barras_apliladas.R
\name{graficar_barras_apiladas}
\alias{graficar_barras_apiladas}
\title{Graficar barras horizontales apiladas a partir de una tabla ancha}
\usage{
graficar_barras_apiladas(
  data,
  var_categoria,
  var_n,
  cols_porcentaje,
  etiquetas_grupos,
  escala_valor = c("proporcion_1", "proporcion_100"),
  colores_grupos = NULL,
  mostrar_valores = TRUE,
  decimales = 1,
  umbral_etiqueta = 0.03,
  mostrar_barra_extra = TRUE,
  barra_extra_preset = c("ninguno", "totales", "top2box", "top3box", "bottom2box"),
  prefijo_barra_extra = "N=",
  titulo_barra_extra = NULL,
  titulo = NULL,
  subtitulo = NULL,
  nota_pie = NULL,
  nota_pie_derecha = NULL,
  pos_titulo = c("centro", "izquierda", "derecha"),
  pos_nota_pie = c("derecha", "izquierda", "centro"),
  color_titulo = "#000000",
  size_titulo = 11,
  color_subtitulo = "#000000",
  size_subtitulo = 9,
  color_nota_pie = "#000000",
  size_nota_pie = 8,
  color_leyenda = "#000000",
  size_leyenda = 8,
  color_texto_barras = "white",
  size_texto_barras = 3,
  color_barra_extra = "#000000",
  size_barra_extra = 3,
  color_ejes = "#000000",
  size_ejes = 9,
  color_fondo = NA,
  grosor_barras = 0.7,
  extra_derecha_rel = 0.1,
  mostrar_leyenda = TRUE,
  invertir_leyenda = FALSE,
  invertir_barras = FALSE,
  invertir_segmentos = FALSE,
  textos_negrita = NULL,
  exportar = c("rplot", "png", "ppt", "word"),
  path_salida = NULL,
  ancho = 10,
  alto = 6,
  alto_por_categoria = NULL,
  dpi = 300
)
}
\arguments{
\item{data}{Data frame en formato ancho que contiene la categoría, la base N
y las columnas de porcentajes.}

\item{var_categoria}{Nombre (string) de la columna que define cada barra
(por ejemplo, \code{"condicion"}).}

\item{var_n}{Nombre (string) de la columna con el N total por categoría
(se usa como base para la barra extra; típicamente el N).}

\item{cols_porcentaje}{Vector de nombres de columnas con los porcentajes
que deben formar los segmentos apilados.}

\item{etiquetas_grupos}{Vector de caracteres con nombre (named) que asigna
etiquetas legibles a las columnas de \code{cols_porcentaje}. Los nombres
deben coincidir exactamente con los nombres de \code{cols_porcentaje}.}

\item{escala_valor}{Escala de los porcentajes: \code{"proporcion_1"} si los
valores están en 0–1, o \code{"proporcion_100"} si están en 0–100.}

\item{colores_grupos}{Vector de colores HEX con nombre (opcional) para los
segmentos, usando como nombres las etiquetas de \code{etiquetas_grupos}.
Si se omite, \pkg{ggplot2} asignará colores por defecto.}

\item{mostrar_valores}{Lógico; si \code{TRUE}, muestra porcentajes dentro
de cada segmento.}

\item{decimales}{Número de decimales para los porcentajes internos.}

\item{umbral_etiqueta}{Mínima proporción para mostrar texto dentro de un
segmento (por ejemplo, 0.03 equivale a 3\\%).}

\item{mostrar_barra_extra}{Lógico; si \code{TRUE}, agrega una “barra extra”
de texto al extremo derecho de cada barra (típicamente para mostrar el N
o algún indicador agregado como “Top 2 Box”).}

\item{barra_extra_preset}{Preset para la barra extra. Puede ser:
\itemize{
\item \code{"ninguno"}: comportamiento manual, usa \code{prefijo_barra_extra}
y \code{titulo_barra_extra} con el valor de \code{var_n}.
\item \code{"totales"}: muestra N total; por defecto
\code{prefijo_barra_extra = "N="}, \code{titulo_barra_extra = "Total"}.
\item \code{"top2box"}: suma los 2 valores más altos de cada fila.
\item \code{"top3box"}: suma los 3 valores más altos de cada fila.
\item \code{"bottom2box"}: suma los 2 valores más bajos de cada fila.
}}

\item{prefijo_barra_extra}{Texto añadido antes del valor mostrado en la
barra extra (por defecto \code{"N="}). Puede ser sobreescrito por el preset.}

\item{titulo_barra_extra}{Texto que se coloca como encabezado encima de la
columna de barra extra (por ejemplo, "Total", "Top 2 Box"). Si es
\code{NULL}, no se agrega encabezado. Puede ser sobreescrito por el preset.}

\item{titulo}{Título del gráfico.}

\item{subtitulo}{Subtítulo opcional del gráfico.}

\item{nota_pie}{Nota o fuente para colocar en el pie de página del gráfico.}

\item{nota_pie_derecha}{Texto adicional para el pie de página que se
concatenará a la derecha de \code{nota_pie} (por ejemplo, "N total = 52").
Ambos se muestran en una única línea de caption.}

\item{pos_titulo}{Alineación horizontal del título. Puede ser
\code{"centro"}, \code{"izquierda"} o \code{"derecha"}.}

\item{pos_nota_pie}{Alineación horizontal de la nota al pie (caption). Puede ser
\code{"derecha"}, \code{"izquierda"} o \code{"centro"}.}

\item{color_titulo}{Color del título.}

\item{size_titulo}{Tamaño del título.}

\item{color_subtitulo}{Color del subtítulo.}

\item{size_subtitulo}{Tamaño del subtítulo.}

\item{color_nota_pie}{Color del texto del pie de página.}

\item{size_nota_pie}{Tamaño del texto del pie de página.}

\item{color_leyenda}{Color del texto de la leyenda.}

\item{size_leyenda}{Tamaño del texto de la leyenda.}

\item{color_texto_barras}{Color del texto dentro de los segmentos.}

\item{size_texto_barras}{Tamaño del texto dentro de los segmentos.}

\item{color_barra_extra}{Color base del texto de la barra extra (se puede
sobreescribir internamente si se usa un preset).}

\item{size_barra_extra}{Tamaño del texto de la barra extra.}

\item{color_ejes}{Color del texto de las categorías en el eje Y.}

\item{size_ejes}{Tamaño del texto de las categorías en el eje Y.}

\item{color_fondo}{Color de fondo del gráfico. Si es \code{NA} (por defecto),
el fondo será transparente (útil para insertar en PPT/Word).}

\item{grosor_barras}{Ancho relativo de las barras (argumento \code{width} de
\code{geom_col()}). Toma valores típicos entre 0 y 1. Por defecto 0.7.}

\item{extra_derecha_rel}{Porcentaje adicional a la derecha para ubicar la
barra extra, relativo a la longitud de la barra más larga.}

\item{mostrar_leyenda}{Lógico; si \code{FALSE}, oculta la leyenda.}

\item{invertir_leyenda}{Lógico; si \code{TRUE}, invierte el orden de los
ítems de la leyenda sin alterar el orden de las barras ni de los segmentos.}

\item{invertir_barras}{Lógico; si \code{TRUE}, invierte el orden en que las
categorías aparecen en el eje Y (orden vertical de las barras).}

\item{invertir_segmentos}{Lógico; si \code{TRUE}, invierte el orden en que se
apilan los segmentos dentro de cada barra (orden horizontal de los colores).}

\item{textos_negrita}{Vector de caracteres que indica qué elementos deben
mostrarse en negrita. Puede incluir cualquiera de:
\code{"titulo"}, \code{"porcentajes"}, \code{"leyenda"}, \code{"barra_extra"}.}

\item{exportar}{Método de salida:
\itemize{
\item \code{"rplot"}: devuelve un objeto \code{ggplot}.
\item \code{"png"}: exporta un archivo PNG.
\item \code{"ppt"}: exporta un PPTX con el gráfico vectorial editable.
\item \code{"word"}: exporta un DOCX con el gráfico vectorial editable.
}}

\item{path_salida}{Ruta del archivo a crear cuando \code{exportar} no es
\code{"rplot"}.}

\item{ancho}{Ancho del gráfico (cuando se exporta a archivo).}

\item{alto}{Alto del gráfico (cuando se exporta a archivo).}

\item{alto_por_categoria}{Alto (en pulgadas) a asignar por categoría cuando
no se especifica \code{alto}. Si es \code{NULL}, se usan los valores por
defecto históricos.}

\item{dpi}{Resolución en puntos por pulgada (solo para PNG).}
}
\value{
Un objeto \code{ggplot} si \code{exportar = "rplot"}. De forma
invisible, el gráfico exportado si se utiliza \code{"png"}, \code{"ppt"}
o \code{"word"}.
}
\description{
Genera un gráfico de barras horizontales apiladas donde cada categoría
(por ejemplo, enfermedades, regiones o grupos etarios) se muestra como una
barra compuesta por proporciones asociadas a diferentes estados o respuestas.
La función está pensada para usarse directamente con tablas de indicadores
ya calculadas (formato ancho), sin necesidad de reestructurar los datos
manualmente.
}
