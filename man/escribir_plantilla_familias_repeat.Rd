% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/codificacion.R
\name{escribir_plantilla_familias_repeat}
\alias{escribir_plantilla_familias_repeat}
\title{Escribir plantilla de familias (versión repeat-aware, enmascarada)}
\usage{
escribir_plantilla_familias_repeat(
  inst,
  tabs,
  path = "familias_repeat.xlsx",
  incluir_text_vars = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{inst}{list. Instrumento leído con \code{leer_instrumento_xlsform()} (debe
traer \code{inst$survey} y, si es posible, \code{inst$survey_raw}).}

\item{tabs}{list. Salida de \code{lector_codif_repeat()} (nombres esperados:
\code{main} y las hojas hijas en minúsculas y snake case), donde cada entrada
es una lista con \code{raw}, \code{clean}, \code{name_map}.}

\item{path}{character. Ruta de salida del Excel único. Default \code{"familias_repeat.xlsx"}.}

\item{incluir_text_vars}{logical. Incluir preguntas \code{text} como filas. Default \code{TRUE}.}

\item{verbose}{logical. Mensajes por consola. Default \code{TRUE}.}
}
\value{
Ruta absoluta al archivo escrito (invisible).
}
\description{
Genera \strong{un único Excel} con las sugerencias de familias para todas las
secciones del instrumento (main y repeats), \strong{sin duplicar} el cuestionario.
Se apoya en \code{codif_detector_repeat()} para filtrar las preguntas que
pertenecen a cada sección, y resuelve \code{parent_col}, \code{text_col} y dummies
usando los nombres \strong{originales} de la hoja de datos correspondiente
en \code{tabs} (tal como los creó \code{lector_codif_repeat()}).
}
\details{
Colorea filas por \code{tipo} (select_one / select_multiple / text) y destaca
las columnas \code{other_dummy_col} y \code{text_col} con borde y encabezado pastel.
}
\examples{
\dontrun{
inst <- leer_instrumento_xlsform("RMS_instrumento.xlsx")
tabs <- lector_codif_repeat(path_xlsx, main_sheet="RMS 2025 Perú - Q4",
                            repeat_sheets=c("rpt_hhmnames","S1","CHILDEDUPE"))
escribir_plantilla_familias_repeat_mask(inst, tabs, path="RMS_familias.xlsx")
}
}
