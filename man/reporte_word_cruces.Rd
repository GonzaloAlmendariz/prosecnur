% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generador_word_cruces.R
\name{reporte_word_cruces}
\alias{reporte_word_cruces}
\title{Generar un reporte Word a partir de cruces (SO/SM vs estrato) con graficadores propios}
\usage{
reporte_word_cruces(
  data,
  instrumento = NULL,
  secciones,
  var_cruce,
  path_word = "reporte_word_cruces.docx",
  fuente = NULL,
  sm_vars_force = NULL,
  weight_col = "peso",
  mostrar_todo = FALSE,
  solo_lista = FALSE,
  incluir_titulo_var = TRUE,
  mensajes_progreso = TRUE,
  vars_dico = NULL,
  vars_barras_apiladas = NULL,
  vars_barras_agrupadas = NULL,
  vars_radar = NULL,
  listnames_dico = NULL,
  listnames_apiladas = NULL,
  dico_labels_por_var = list(),
  dico_labels_por_listname = list(),
  colores_apiladas_por_listname = list(),
  default_so = c("barras_agrupadas", "barras_apiladas"),
  default_sm = c("barras_agrupadas", "barras_apiladas"),
  barra_extra = c("ninguna", "total_n"),
  estilos_barras_agrupadas = list(),
  estilos_barras_apiladas = list(),
  estilos_dico = list(),
  colores_estratos = NULL,
  opciones_excluir = NULL,
  template_docx = NULL,
  mostrar_resumen_n = TRUE,
  labels_override = NULL
)
}
\arguments{
\item{data}{Data frame o tibble con la base de datos a cruzar. Debe contener
las variables de \code{secciones} y la variable \code{var_cruce}.}

\item{instrumento}{Objeto devuelto por \code{reporte_instrumento()}. Si es
\code{NULL}, se intentará recuperar desde \code{attr(data, "instrumento_reporte")}.
Debe contener al menos las tibbles \code{survey} y \code{choices} y,
opcionalmente, \code{orders_list}.}

\item{secciones}{Lista nombrada de secciones; cada elemento es un vector de
nombres de variables que se cruzarán con \code{var_cruce}.}

\item{var_cruce}{Nombre de la variable de estrato (columna de \code{data})
con la que se cruzarán todas las variables de \code{secciones}.}

\item{path_word}{Ruta del archivo DOCX a generar cuando \code{solo_lista = FALSE}.}

\item{fuente}{Texto de fuente que se mostrará en el bloque de texto inferior
izquierdo de cada diapositiva de gráficos.}

\item{sm_vars_force}{Vector opcional de nombres de variables que deben tratarse
como \code{select_multiple} aunque el instrumento no las marque como tales.}

\item{weight_col}{Nombre de la variable de pesos (por defecto \code{"peso"}).}

\item{mostrar_todo}{Reservado para coherencia; no se usa explícitamente en
esta función (el comportamiento depende de \code{get_categorias()}).}

\item{solo_lista}{Lógico; si \code{TRUE}, no se genera PPT y solo se devuelve
una lista con \code{plots} y \code{log_decisiones}. Si \code{FALSE}, además
se construye \code{path_ppt}.}

\item{incluir_titulo_var}{Lógico; si \code{TRUE}, el label de la variable se
usa como título de la diapositiva (placeholder de título). Los gráficos se
generan sin título interno.}

\item{mensajes_progreso}{Lógico; si \code{TRUE}, muestra mensajes por consola
indicando el tipo de gráfico usado para cada variable.}

\item{vars_dico}{Vector de nombres de variables que se deben graficar como
dicotómicas mediante \code{graficar_dico()}, siempre que exista una pareja
de etiquetas en \code{dico_labels_por_var} o \code{dico_labels_por_listname}.}

\item{vars_barras_apiladas}{Vector de nombres de variables que se deben
graficar como barras horizontales apiladas mediante
\code{graficar_barras_apiladas()}.}

\item{vars_barras_agrupadas}{Vector de nombres de variables que se deben
graficar como barras agrupadas mediante \code{graficar_barras_agrupadas()}.}

\item{vars_radar}{Reservado; actualmente no se implementa salida tipo radar.}

\item{listnames_dico}{Vector de \code{list_name} para los que, si una variable
no aparece en \code{vars_dico}, se intentará por defecto tratarla como
dicotómica.}

\item{listnames_apiladas}{Vector de \code{list_name} para los que, si una
variable no aparece en \code{vars_barras_apiladas} ni en \code{vars_dico},
se intentará por defecto graficar como barras apiladas.}

\item{dico_labels_por_var}{Lista nombrada donde cada elemento es un vector
de dos etiquetas \code{c("Positiva","Negativa")} para la variable
correspondiente.}

\item{dico_labels_por_listname}{Lista nombrada por \code{list_name} donde cada
elemento es un vector de dos etiquetas \code{c("Positiva","Negativa")} que
se usan cuando la variable no tiene entrada propia en \code{dico_labels_por_var}.}

\item{colores_apiladas_por_listname}{Lista nombrada por \code{list_name} donde
cada elemento puede ser:
\itemize{
\item Un vector nombrado de colores HEX (forma clásica).
\item Una lista con elementos \code{colores} y
\code{preset_barra_extra}, para controlar tanto colores como la
barra extra en \code{graficar_barras_apiladas()}.
}}

\item{default_so}{Tipo de gráfico por defecto para variables \code{select_one}
cuando no se encuentren en ninguna lista de overrides. Puede ser
\code{"barras_agrupadas"} o \code{"barras_apiladas"}.}

\item{default_sm}{Tipo de gráfico por defecto para variables \code{select_multiple}
cuando no se encuentren en ninguna lista de overrides. Igual que
\code{default_so}, puede ser \code{"barras_agrupadas"} o
\code{"barras_apiladas"}.}

\item{barra_extra}{Controla si se agrega o no una barra final con el N total
en barras apiladas/agrupadas (cuando no se usa un preset específico).
Puede ser:
\itemize{
\item \code{"ninguna"}: no se agrega barra extra.
\item \code{"total_n"}: se agrega barra extra con el N total (\code{"N = ..."}).
}}

\item{estilos_barras_agrupadas}{Lista de parámetros de estilo que se pasan
directamente a \code{graficar_barras_agrupadas()}.}

\item{estilos_barras_apiladas}{Lista de parámetros de estilo que se pasan
directamente a \code{graficar_barras_apiladas()}.}

\item{estilos_dico}{Lista de parámetros de estilo que se pasan directamente a
\code{graficar_dico()}.}

\item{colores_estratos}{Vector nombrado opcional de colores HEX para los
estratos en barras agrupadas (nombres = etiquetas de estrato). Si se
define \code{estilos_barras_agrupadas$colores_series}, tiene prioridad.}

\item{opciones_excluir}{Vector de labels de opciones a excluir de la
variable de interés (por ejemplo, categorías de no respuesta).}

\item{template_docx}{Ruta a una plantilla DOCX. Si es \code{NULL}, se intentará
usar una plantilla interna del paquete llamada
\code{"plantillas/plantilla_pulso.docx"}; si tampoco existe, se usará la
plantilla por defecto de Word a través de \code{officer::read_docx()}.}

\item{mostrar_resumen_n}{Lógico; si \code{TRUE}, en cada diapositiva de
gráficos se escribe en el bloque de texto inferior derecho un resumen del
tipo \code{"N = X | Ratio de respuestas: Y\%"}.}

\item{labels_override}{Lista nombrada opcional para sobrescribir etiquetas
de preguntas (se usa en los títulos de las diapositivas).}
}
\value{
Una lista con dos elementos:
\describe{
\item{plots}{Lista de objetos \code{ggplot} generados (uno por variable).}
\item{log_decisiones}{Tibble con información sobre cada variable procesada:
sección, nombre de variable, estrato, tipo de pregunta, \code{list_name},
origen de la decisión (\code{override}) y tipo de gráfico final.}
}
}
\description{
\code{reporte_word_cruces()} toma una base de datos, el instrumento, una definición
de secciones y una variable de cruce (\code{var_cruce}) y genera:
\itemize{
\item Una lista de gráficos \code{ggplot} (uno por variable de las secciones).
\item Opcionalmente, un archivo DOCX donde cada gráfico ocupa un bloque en
páginas sucesivas, precedidos por una página de índice.
}
}
\details{
La lógica de construcción de cruces es idéntica a \code{reporte_ppt_cruces()}:
véase esa función para más detalles conceptuales.
}
