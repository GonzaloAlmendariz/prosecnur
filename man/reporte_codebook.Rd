% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generalidad_codebook.R
\name{reporte_codebook}
\alias{reporte_codebook}
\title{Generar libro de códigos en Excel a partir de una base de reporte}
\usage{
reporte_codebook(
  data,
  path_xlsx = "codebook_from_data.xlsx",
  sheet = "Codebook",
  ord = NULL
)
}
\arguments{
\item{data}{Un \code{data.frame} o \code{tibble}, idealmente el objeto devuelto por
\code{\link[=reporte_data]{reporte_data()}}, que contiene los atributos \code{label} y \code{labels}.}

\item{path_xlsx}{Ruta del archivo Excel a generar. Por defecto
\code{"codebook_from_data.xlsx"}.}

\item{sheet}{Nombre de la hoja donde se escribirá el codebook. Por defecto
\code{"Codebook"}.}

\item{ord}{Lista opcional con información adicional de orden y etiquetas
(por ejemplo, \code{orders_list} generado en fases previas). Si es \code{NULL},
la función intentará recuperarla desde
\code{attr(data, "instrumento_reporte")$orders_list}, si existe.}
}
\value{
Invisiblemente, la ruta normalizada del archivo Excel generado.
}
\description{
\code{reporte_codebook()} toma una base ya adaptada para reporte (típicamente el
resultado de \code{\link[=reporte_data]{reporte_data()}}) y genera un libro de códigos en formato Excel.
La información se toma de los atributos de cada variable:
\itemize{
\item \code{attr(, "label")} para la etiqueta de la variable.
\item \code{attr(, "labels")} para los value-labels (códigos y etiquetas).
}
}
\details{
Opcionalmente, si el objeto \code{data} conserva el atributo
\code{instrumento_reporte} (tal como lo asigna \code{\link[=reporte_data]{reporte_data()}}) y este contiene
un elemento \code{orders_list}, se utilizará como insumo adicional para el
orden y descripción de los valores.

El layout del Excel sigue una estructura pensada para documentación:
\enumerate{
\item Nombre de la variable en una fila propia (itálica).
\item Fila de "Atributos estándar" con la etiqueta de la variable.
\item Bloque "Valores válidos" con códigos y etiquetas, en columnas
separadas.
}
}
\examples{
\dontrun{
  rp_data <- reporte_data(data_cruda_adaptada, rp_inst)
  reporte_codebook(rp_data, path_xlsx = "codebook_OPS_EES.xlsx")
}

}
