% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/graficar_barras_agrupadas.R
\name{graficar_barras_agrupadas}
\alias{graficar_barras_agrupadas}
\title{Graficar barras horizontales agrupadas a partir de una tabla ancha}
\usage{
graficar_barras_agrupadas(
  data,
  var_categoria,
  var_n,
  cols_porcentaje,
  etiquetas_series,
  escala_valor = c("proporcion_1", "proporcion_100"),
  colores_series = NULL,
  mostrar_valores = TRUE,
  decimales = 1,
  umbral_etiqueta = 0.03,
  umbral_posicion = 0.15,
  sufijo_etiqueta = "",
  mostrar_barra_extra = TRUE,
  prefijo_barra_extra = "N=",
  titulo_barra_extra = NULL,
  titulo = NULL,
  subtitulo = NULL,
  nota_pie = NULL,
  nota_pie_derecha = NULL,
  pos_titulo = c("centro", "izquierda", "derecha"),
  pos_nota_pie = c("derecha", "izquierda", "centro"),
  color_titulo = "#004B8D",
  size_titulo = 11,
  color_subtitulo = "#004B8D",
  size_subtitulo = 9,
  color_nota_pie = "#004B8D",
  size_nota_pie = 8,
  color_leyenda = "#004B8D",
  size_leyenda = 8,
  color_texto_barras = "white",
  color_texto_barras_fuera = "#004B8D",
  size_texto_barras = 3,
  color_barra_extra = "#004B8D",
  size_barra_extra = 3,
  color_ejes = "#004B8D",
  size_ejes = 9,
  color_fondo = NA,
  grosor_barras = 0.6,
  extra_derecha_rel = 0.25,
  espacio_izquierda_rel = 0.05,
  ancho_max_eje_y = NULL,
  mostrar_leyenda = TRUE,
  invertir_leyenda = FALSE,
  invertir_barras = FALSE,
  invertir_series = FALSE,
  textos_negrita = NULL,
  exportar = c("rplot", "png", "ppt", "word"),
  path_salida = NULL,
  ancho = 10,
  alto = 6,
  alto_por_categoria = NULL,
  dpi = 300
)
}
\arguments{
\item{data}{Data frame en formato ancho que contiene la categoría, la base N
y las columnas de porcentajes.}

\item{var_categoria}{Nombre (string) de la columna que define cada categoría
en el eje vertical (por ejemplo, \code{"servicio"} o \code{"condicion"}).}

\item{var_n}{Nombre (string) de la columna con el N total por categoría
(se usa para mostrar una etiqueta adicional, típicamente \code{"N="}, al
extremo derecho de las barras).}

\item{cols_porcentaje}{Vector de nombres de columnas con los porcentajes
que se desean comparar como series agrupadas (por ejemplo,
\code{c("pct_area", "pct_mr")}).}

\item{etiquetas_series}{Vector de caracteres con nombre (named) que asigna
etiquetas legibles a las columnas de \code{cols_porcentaje}. Los nombres
deben coincidir exactamente con los nombres de \code{cols_porcentaje}.
Los valores (etiquetas) se usan en la leyenda.}

\item{escala_valor}{Escala de los porcentajes: \code{"proporcion_1"} si los
valores están en 0–1, o \code{"proporcion_100"} si están en 0–100.}

\item{colores_series}{Vector de colores HEX con nombre (opcional) para las
series, usando como nombres las etiquetas de \code{etiquetas_series}. Si
se omite, \pkg{ggplot2} asignará colores por defecto.}

\item{mostrar_valores}{Lógico; si \code{TRUE}, muestra los porcentajes
asociados a cada barra.}

\item{decimales}{Número de decimales para los porcentajes.}

\item{umbral_etiqueta}{Mínima proporción (en escala 0–1) para mostrar texto
(por ejemplo, 0.03 equivale a 3\\%). Por debajo de este valor, no se
muestra la etiqueta.}

\item{umbral_posicion}{Proporción (0–1) que define desde qué tamaño de barra
el porcentaje se dibuja centrado dentro de la barra. Si la barra es
menor a este umbral, el porcentaje se dibuja ligeramente a la derecha del
final de la barra.}

\item{sufijo_etiqueta}{String opcional que se añade al final de cada
etiqueta de porcentaje (por ejemplo, \code{" pts"}). Se aplica solo a las
etiquetas visibles.}

\item{mostrar_barra_extra}{Lógico; si \code{TRUE}, agrega una "barra extra"
de texto al extremo derecho de cada categoría (típicamente el N, por
ejemplo \code{"N=305"}).}

\item{prefijo_barra_extra}{Texto añadido antes del valor mostrado en la
barra extra (por defecto \code{"N="}).}

\item{titulo_barra_extra}{Texto que se coloca como encabezado encima de la
columna de barra extra (por ejemplo, \code{"Total"}). Si es \code{NULL}, no se
agrega encabezado.}

\item{titulo}{Título del gráfico.}

\item{subtitulo}{Subtítulo opcional del gráfico.}

\item{nota_pie}{Nota o fuente para el pie de página.}

\item{nota_pie_derecha}{Texto adicional para el pie de página que se
concatenará a la derecha de \code{nota_pie}.}

\item{pos_titulo}{Alineación horizontal del título: \code{"centro"}, \code{"izquierda"}
o \code{"derecha"}.}

\item{pos_nota_pie}{Alineación horizontal de la nota al pie (caption):
\code{"derecha"}, \code{"izquierda"} o \code{"centro"}.}

\item{color_titulo, size_titulo, color_subtitulo, size_subtitulo, }{color_nota_pie,size_nota_pie,color_leyenda,size_leyenda,
color_texto_barras,color_texto_barras_fuera,size_texto_barras,
color_barra_extra,size_barra_extra,color_ejes,size_ejes,
color_fondo Parámetros estéticos.}

\item{grosor_barras}{Grosor relativo de cada barra dentro de su grupo.}

\item{extra_derecha_rel}{Porción adicional a la derecha, en unidades de
proporción, para la barra extra.}

\item{espacio_izquierda_rel}{Proporción del rango del eje de porcentajes
que se deja como espacio en blanco en el extremo izquierdo. Para
\code{escala_valor} proporcional, el eje se fija en 0 sin expansión extra.}

\item{ancho_max_eje_y}{Número aproximado de caracteres por línea para las
etiquetas de las categorías (eje Y tras el \code{coord_flip}). Si no es
\code{NULL}, se insertan saltos de línea automáticos entre palabras usando
\pkg{stringr}.}

\item{mostrar_leyenda, invertir_leyenda, invertir_barras, invertir_series}{Controles de leyenda y orden.}

\item{textos_negrita}{Vector que puede incluir \code{"titulo"}, \code{"porcentajes"},
\code{"leyenda"} y/o \code{"barra_extra"}.}

\item{exportar}{\code{"rplot"}, \code{"png"}, \code{"ppt"} o \code{"word"}.}

\item{path_salida}{Ruta del archivo cuando \code{exportar != "rplot"}.}

\item{ancho, alto}{Parámetros de tamaño del gráfico.}

\item{alto_por_categoria}{Alto (en pulgadas) a asignar por categoría en el
área de barras cuando no se especifica \code{alto}. Sobre ese alto se suma
automáticamente un bloque fijo para la leyenda (si \code{mostrar_leyenda})
y otro más pequeño para el caption (si existe), y luego se acota entre un
mínimo y un máximo razonables para mantener la consistencia visual.}

\item{dpi}{Resolución para PNG.}
}
\value{
Un objeto \code{ggplot} si \code{exportar = "rplot"}.
}
\description{
Genera un gráfico de barras horizontales agrupadas donde cada categoría
(por ejemplo, servicios, enfermedades, regiones) se muestra en el eje
vertical, y para cada una se comparan dos o más porcentajes en el eje
horizontal (por ejemplo, "\% capacitado en el área" y "\% capacitado en M&R").
}
\details{
La función está pensada para usarse directamente con tablas de indicadores
ya calculadas (formato ancho), sin necesidad de reestructurar los datos
manualmente.
}
