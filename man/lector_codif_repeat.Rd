% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/codificacion.R
\name{lector_codif_repeat}
\alias{lector_codif_repeat}
\title{Lector de datos con secciones repeat (main + hojas hijas)}
\usage{
lector_codif_repeat(path, main_sheet, repeat_sheets = NULL)
}
\arguments{
\item{path}{Ruta al archivo Excel de datos.}

\item{main_sheet}{Nombre de la hoja principal (por ejemplo, "RMS 2025 Perú - Q4").}

\item{repeat_sheets}{Vector opcional con los nombres exactos de las hojas hijas
(por ejemplo, \code{c("S1", "rpt_hhmnames", "CHILDEDUPE")}).}
}
\value{
Una lista con una entrada por hoja leída. Cada entrada contiene:
\itemize{
\item \code{raw}: datos originales.
\item \code{clean}: datos con nombres limpios.
\item \code{name_map}: tabla de correspondencia de nombres.
}
}
\description{
Lee de un mismo archivo Excel la hoja principal del estudio y,
opcionalmente, una o más hojas hijas correspondientes a secciones \emph{repeat}.
Devuelve una lista con elementos nombrados (\code{main}, \code{s1}, \code{rpt_hhmnames}, etc.),
donde cada elemento contiene las tres estructuras estándar generadas por
\code{leer_datos()}:
\itemize{
\item \code{raw}: datos crudos leídos directamente de Excel.
\item \code{clean}: versión limpiada (nombres normalizados).
\item \code{name_map}: correspondencia entre nombres originales y limpios.
}
}
\details{
La función está diseñada para usarse antes de procesos de codificación o
construcción de plantillas, de modo que la lista resultante (\code{tabs})
pueda ser pasada directamente a funciones como
\code{escribir_plantilla_familias()} o \code{leer_familias_clasificar()}.

Si alguna de las hojas especificadas no se encuentra en el archivo, la función
devuelve un mensaje de advertencia y omite esa hoja, sin interrumpir la ejecución.

Los nombres de los elementos en la lista final se normalizan usando
\code{janitor::make_clean_names()} (en minúsculas y sin espacios).
}
\examples{
\dontrun{
# Ejemplo de uso
path_xlsx <- "RMS_datos_filtrado.xlsx"

tabs <- lector_codif_repeat(
  path = path_xlsx,
  main_sheet = "RMS 2025 Perú - Q4",
  repeat_sheets = c("rpt_hhmnames", "S1", "CHILDEDUPE")
)

names(tabs)
# [1] "main" "rpt_hhmnames" "s1" "childedupe"

lapply(tabs, names)
# Cada elemento contiene: raw, clean, name_map
}

}
\seealso{
\code{\link{leer_datos}}, \code{\link{escribir_plantilla_familias}}
}
