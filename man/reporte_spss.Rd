% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generalidad_export_spss.R
\name{reporte_spss}
\alias{reporte_spss}
\title{Exportar una base de reporte a formato SPSS (.sav)}
\usage{
reporte_spss(data, path_sav, compress = TRUE, ...)
}
\arguments{
\item{data}{Un \code{data.frame} o \code{tibble}, preferentemente el objeto devuelto
por \code{\link[=reporte_data]{reporte_data()}} (clase \code{"prosecnur_reporte_tbl"}).}

\item{path_sav}{Ruta del archivo \code{.sav} a generar. Debe incluir la extensión,
por ejemplo \code{"estudio_final.sav"}.}

\item{compress}{Lógico; se pasa a \code{\link[haven:read_spss]{haven::write_sav()}}. Por defecto \code{TRUE}.}

\item{...}{Argumentos adicionales que se pasan directamente a
\code{\link[haven:read_spss]{haven::write_sav()}}.}
}
\value{
Invisiblemente, el \code{data.frame} ya transformado (con clases
\code{labelled_spss}, tipos de fecha/hora ajustados, etc.). Como efecto
secundario, se escribe el archivo \code{.sav} en \code{path_sav} y se imprime en
consola un breve resumen sobre la aplicación de labels.
}
\description{
\code{reporte_spss()} toma una base ya adaptada para reporte (típicamente el
resultado de \code{\link[=reporte_data]{reporte_data()}}) y la convierte a un objeto compatible con
SPSS, aplicando:
\itemize{
\item Conversión de variables con etiquetas de valor (\code{attr(, "labels")})
a objetos \code{haven::labelled_spss()}, usando códigos numéricos y
manteniendo los \code{label} de variable y el nivel de medición
(\code{attr(, "measure")}).
\item Conversión de variables de fecha, hora y fecha-hora según los
metadatos del instrumento (\code{vars_fecha}, \code{vars_hora}, \code{vars_datetime}).
\item Renombrado de \verb{_uuid} a \code{uuid} si fuese necesario.
\item Escritura a disco en formato \code{.sav} mediante \code{\link[haven:read_spss]{haven::write_sav()}}.
}
}
\details{
La lógica asume que la base de entrada ya pasó por las etapas de:
\enumerate{
\item Evaluación de consistencia.
\item Recodificación/adaptación de instrumento y data.
\item Preparación para reporte con \code{\link[=reporte_data]{reporte_data()}}, donde se asignan
\code{label}, \code{labels} y \code{measure}, y se identifican variables de fecha
y hora.
}

Además, la función realiza una comprobación básica de la aplicación de
etiquetas: cuenta cuántas variables con \code{labels} fueron convertidas a
\code{labelled_spss}, e identifica posibles problemas al convertir el contenido
a numérico (por ejemplo, si todo quedó en \code{NA}).
}
\examples{
\dontrun{
  rp_inst <- reporte_instrumento("instrumento.xlsx", ...)
  rp_data <- reporte_data(data_cruda_adaptada, rp_inst)

  reporte_spss(rp_data, path_sav = "estudio_2025.sav")
}

}
