% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/aplicacion-codificacion-instrumento.R
\name{ppra_adaptar_instrumento}
\alias{ppra_adaptar_instrumento}
\title{ppra_adaptar_instrumento}
\usage{
ppra_adaptar_instrumento(
  path_instrumento_in,
  path_data_adaptada,
  path_instrumento_out = "instrumento_adaptado.xlsx",
  sm_vars = character(0),
  so_parent_vars = character(0),
  so_child_vars = character(0),
  choices_order = c("original_first", "by_first_seen", "alphabetical"),
  paint = TRUE
)
}
\arguments{
\item{path_instrumento_in}{XLSX original (hojas \code{survey} y \code{choices})}

\item{path_data_adaptada}{XLSX o \code{data.frame} con columnas *_recod generadas}

\item{path_instrumento_out}{XLSX de salida}

\item{sm_vars}{vector de padres select_multiple}

\item{so_parent_vars}{vector de select_one que recodifican el \strong{padre}}

\item{so_child_vars}{vector de select_one cuyo recodificado está en el \strong{hijo};
la/las columnas a agregar se detectan en la data como \verb{^<parent>_.*_recod$}
(excluyendo \verb{<parent>_recod})}

\item{choices_order}{"original_first" (default), "by_first_seen", "alphabetical"}

\item{paint}{TRUE para colorear filas nuevas}
}
\value{
lista con \code{survey}, \code{choices}, \code{out_path}
}
\description{
Genera un \strong{XLSForm adaptado} desde un instrumento base y una \strong{data ya adaptada}
(salida de \code{ppra_adaptar_data_simple}), creando:
\itemize{
\item \strong{SM}: \verb{<parent>_recod} (select_multiple).
\item \strong{SO-padre}: \verb{<parent>_recod} (select_one) usando el catálogo del padre.
\item \strong{SO-hijo}: \verb{<parent>_<alias>_recod} (select_one), con \strong{lista propia}
(tokens observados en la data).
Inserta cada nueva pregunta \strong{debajo} de su base y \strong{colorea}:
SM (verde), SO (azul). También colorea las filas de \code{choices} del list creado.
}
}
